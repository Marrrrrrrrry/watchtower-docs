import{_ as a}from"./chunks/grafana-dashboard.CRj4N4bI.js";import{_ as t,c as e,o as i,ae as n}from"./chunks/framework.CBQY1fUt.js";const E=JSON.parse('{"title":"指标","description":"","frontmatter":{},"headers":[],"relativePath":"zh/metrics/index.md","filePath":"zh/metrics/index.md","lastUpdated":1763853533000}'),r={name:"zh/metrics/index.md"};function p(h,s,d,l,c,o){return i(),e("div",null,[...s[0]||(s[0]=[n(`<h1 id="指标" tabindex="-1">指标 <a class="header-anchor" href="#指标" aria-label="Permalink to &quot;指标&quot;">​</a></h1><div class="warning custom-block"><p class="custom-block-title">实验特性</p><p>该功能在 v1.0.4 中加入，仍处于实验阶段。如发现异常行为，请在仓库 Issues 中反馈。</p></div><p>指标可用于跟踪 Watchtower 随时间的行为。</p><p>要使用该功能，需要设置一个 <a href="/watchtower-docs/zh/arguments/#http-api-token">API token</a> 并 <a href="/watchtower-docs/zh/arguments/#http-api-metrics">启用 metrics API</a>，同时为容器创建端口 <code>8080</code> 的映射。</p><p>Metrics API 端点为 <code>/v1/metrics</code>。</p><h2 id="可用指标" tabindex="-1">可用指标 <a class="header-anchor" href="#可用指标" aria-label="Permalink to &quot;可用指标&quot;">​</a></h2><table tabindex="0"><thead><tr><th>名称</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td><code>watchtower_containers_scanned</code></td><td>Gauge</td><td>上次扫描中被 watchtower 检查的容器数量</td></tr><tr><td><code>watchtower_containers_updated</code></td><td>Gauge</td><td>上次扫描中被 watchtower 更新的容器数量</td></tr><tr><td><code>watchtower_containers_failed</code></td><td>Gauge</td><td>上次扫描中更新失败的容器数量</td></tr><tr><td><code>watchtower_scans_total</code></td><td>Counter</td><td>watchtower 启动以来进行的扫描总次数</td></tr><tr><td><code>watchtower_scans_skipped</code></td><td>Counter</td><td>watchtower 启动以来被跳过的扫描总次数</td></tr></tbody></table><h2 id="prometheus-scrape-config-示例" tabindex="-1">Prometheus <code>scrape_config</code> 示例 <a class="header-anchor" href="#prometheus-scrape-config-示例" aria-label="Permalink to &quot;Prometheus \`scrape_config\` 示例&quot;">​</a></h2><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">scrape_configs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">job_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">watchtower</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    scrape_interval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5s</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    metrics_path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/v1/metrics</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    bearer_token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">demotoken</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    static_configs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">targets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;watchtower:8080&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>请将 <code>demotoken</code> 替换为你设置的 Bearer token。</p><h2 id="演示" tabindex="-1">演示 <a class="header-anchor" href="#演示" aria-label="Permalink to &quot;演示&quot;">​</a></h2><p>仓库中包含一个基于 Prometheus 与 Grafana 的演示，使用 <code>docker-compose.yml</code> 提供。该演示已预配置了一个仪表板，效果如下：</p><p><img src="`+a+'" alt="grafana metrics"></p>',13)])])}const u=t(r,[["render",p]]);export{E as __pageData,u as default};
