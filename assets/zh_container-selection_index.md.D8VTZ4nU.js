import{_ as a,c as e,o as i,ae as n}from"./chunks/framework.CBQY1fUt.js";const k=JSON.parse('{"title":"容器选择","description":"","frontmatter":{},"headers":[],"relativePath":"zh/container-selection/index.md","filePath":"zh/container-selection/index.md","lastUpdated":1763853533000}'),t={name:"zh/container-selection/index.md"};function l(r,s,p,h,d,o){return i(),e("div",null,[...s[0]||(s[0]=[n(`<h1 id="容器选择" tabindex="-1">容器选择 <a class="header-anchor" href="#容器选择" aria-label="Permalink to &quot;容器选择&quot;">​</a></h1><p>默认情况下，watchtower 会监控所有容器。不过，有时只需要更新部分容器。</p><p>有两种选择：</p><ul><li><strong>完全排除</strong>：可将容器完全排除在 watchtower 监控之外。</li><li><strong>仅监控</strong>：watchtower 仅检查更新、发送通知并触发容器上的 <a href="https://marrrrrrrrry.github.io/watchtower/lifecycle-hooks/" target="_blank" rel="noreferrer">pre-check/post-check 钩子</a>，但不会执行更新。</li></ul><h2 id="完全排除" tabindex="-1">完全排除 <a class="header-anchor" href="#完全排除" aria-label="Permalink to &quot;完全排除&quot;">​</a></h2><p>如需排除某些容器，请在这些容器上设置标签 <code>com.centurylinklabs.watchtower.enable=false</code>（该标签设置在被排除的容器上，不是在 watchtower 容器上）。</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-DZqyb" id="tab-NudyKq_" checked><label data-title="dockerfile" for="tab-NudyKq_">dockerfile</label><input type="radio" name="group-DZqyb" id="tab-Cjg7vmu"><label data-title="docker run" for="tab-Cjg7vmu">docker run</label><input type="radio" name="group-DZqyb" id="tab-xo0LcB9"><label data-title="docker-compose" for="tab-xo0LcB9">docker-compose</label></div><div class="blocks"><div class="language-docker vp-adaptive-theme active line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">docker</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LABEL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> com.centurylinklabs.watchtower.enable=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;false&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --label=com.centurylinklabs.watchtower.enable=false</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> someimage</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;3&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  someimage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    container_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">someimage</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    labels</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;com.centurylinklabs.watchtower.enable=false&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></div></div><p>如果希望 <a href="https://marrrrrrrrry.github.io/watchtower/arguments/#filter_by_enable_label" target="_blank" rel="noreferrer">仅包含设置了 enable 标签的容器</a>，请在 watchtower 启动时传入 <code>--label-enable</code> 或设置环境变量 <code>WATCHTOWER_LABEL_ENABLE=true</code>，并在要监控的容器上设置标签 <code>com.centurylinklabs.watchtower.enable=true</code>。</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-YIk-b" id="tab-8MVlSk4" checked><label data-title="dockerfile" for="tab-8MVlSk4">dockerfile</label><input type="radio" name="group-YIk-b" id="tab-viKBZyo"><label data-title="docker run" for="tab-viKBZyo">docker run</label><input type="radio" name="group-YIk-b" id="tab-HufehS0"><label data-title="docker-compose" for="tab-HufehS0">docker-compose</label></div><div class="blocks"><div class="language-docker vp-adaptive-theme active line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">docker</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LABEL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> com.centurylinklabs.watchtower.enable=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;true&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --label=com.centurylinklabs.watchtower.enable=true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> someimage</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;3&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  someimage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    container_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">someimage</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    labels</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;com.centurylinklabs.watchtower.enable=true&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></div></div><p>如果希望创建监控范围（scope），需要 <a href="https://containrrr.dev/watchtower/running-multiple-instances/" target="_blank" rel="noreferrer">运行多个实例并为各自设置 scope</a>。</p><p>Watchtower 会根据配置的多个条件过滤运行中的容器；仅当所有条件都满足时容器才会被监控。例如：</p><ul><li>如果容器名称在监控列表中（<code>--name</code> 非空），但未启用（<code>com.centurylinklabs.watchtower.enable=false</code>），则不会监控；</li><li>如果容器名称不在监控列表中（<code>--name</code> 非空），即使启用（<code>com.centurylinklabs.watchtower.enable=true</code> 且设置了 <code>--label-enable</code>），也不会监控；</li></ul><h2 id="仅监控" tabindex="-1">仅监控 <a class="header-anchor" href="#仅监控" aria-label="Permalink to &quot;仅监控&quot;">​</a></h2><p>可以将个别容器标记为仅监控（不执行更新）。</p><p>为该容器设置标签 <code>com.centurylinklabs.watchtower.monitor-only=true</code>：</p><div class="language-docker vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">docker</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LABEL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> com.centurylinklabs.watchtower.monitor-only=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;true&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>或者作为 <code>docker run</code> 命令的一部分：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --label=com.centurylinklabs.watchtower.monitor-only=true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> someimage</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>当在容器上设置该标签时，watchtower 会将其视为设置了 <code>WATCHTOWER_MONITOR_ONLY</code>，但该效果仅对该容器生效。</p>`,19)])])}const b=a(t,[["render",l]]);export{k as __pageData,b as default};
